theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Text
text_box <- ggplot()+
annotate("text",
x= 0,
y=0,
label="description",
col='red',
size=10)
#Infographic
infographic <- plot1 /
plot_spacer() /
(plot2| plot3) /
text_box +
plot_layout(heights = c(1000, 0.1, 900,50) , widths = c(20,15,300)) +
plot_annotation(
title = "Effect of Tempetature and Humidity on Bike Rentals"
)
# Display the infographic
infographic
# Scatter plot of Temperature vs Rental Count with Humidity
plot1 <- ggplot(df, aes(x = temp*100, y = cnt, color = hum*100)) +
geom_point(size = 1, alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "brown") +
scale_color_viridis_c(option = "D") +
labs(
title = "Rental Count vs Temperature with Humidity Levels",
x = "Temperature (°C)",
y = "Bike Rentals",
color = "Humidity (%)"
) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Line chart of Bike Rentals vs Temperature
plot2 <- ggplot(df, aes(x=temp, y=cnt)) +
geom_line(color="royalblue") +
labs(title="Bike Rentals vs. Temperature",
x="Temperature",
y="Bike Rentals") +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Boxplot of Bike Rentals by Humidity Level
plot3 <- ggplot(df, aes(x=hum_new, y=cnt, fill=hum_new)) +
geom_boxplot() +
labs(title="Bike Rentals by Humidity Level",
x="Humidity Level",
y="Bike Rentals") +
scale_fill_manual(values=c("lightblue", "lightgreen", "salmon")) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Text
text_box <- ggplot()+
annotate("text",
x= 0,
y=0,
label="description",
col='red',
size=10)
#Infographic
infographic <- plot1 /
plot_spacer() /
(plot2| plot3) /
text_box +
plot_layout(heights = c(1000, 0.1, 900,5000) , widths = c(20,15,300)) +
plot_annotation(
title = "Effect of Tempetature and Humidity on Bike Rentals"
)
# Display the infographic
infographic
# Scatter plot of Temperature vs Rental Count with Humidity
plot1 <- ggplot(df, aes(x = temp*100, y = cnt, color = hum*100)) +
geom_point(size = 1, alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "brown") +
scale_color_viridis_c(option = "D") +
labs(
title = "Rental Count vs Temperature with Humidity Levels",
x = "Temperature (°C)",
y = "Bike Rentals",
color = "Humidity (%)"
) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Line chart of Bike Rentals vs Temperature
plot2 <- ggplot(df, aes(x=temp, y=cnt)) +
geom_line(color="royalblue") +
labs(title="Bike Rentals vs. Temperature",
x="Temperature",
y="Bike Rentals") +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Boxplot of Bike Rentals by Humidity Level
plot3 <- ggplot(df, aes(x=hum_new, y=cnt, fill=hum_new)) +
geom_boxplot() +
labs(title="Bike Rentals by Humidity Level",
x="Humidity Level",
y="Bike Rentals") +
scale_fill_manual(values=c("lightblue", "lightgreen", "salmon")) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Text
text_box <- ggplot()+
annotate("text",
x= 0,
y=0,
label="description",
col='red',
size=10)
#Infographic
infographic <- plot1 /
plot_spacer() /
(plot2| plot3) /
text_box +
plot_layout(heights = c(1000, 0.1, 900,500) , widths = c(20,15,300)) +
plot_annotation(
title = "Effect of Tempetature and Humidity on Bike Rentals"
)
# Display the infographic
infographic
# Scatter plot of Temperature vs Rental Count with Humidity
plot1 <- ggplot(df, aes(x = temp*100, y = cnt, color = hum*100)) +
geom_point(size = 1, alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "brown") +
scale_color_viridis_c(option = "D") +
labs(
title = "Rental Count vs Temperature with Humidity Levels",
x = "Temperature (°C)",
y = "Bike Rentals",
color = "Humidity (%)"
) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Line chart of Bike Rentals vs Temperature
plot2 <- ggplot(df, aes(x=temp, y=cnt)) +
geom_line(color="royalblue") +
labs(title="Bike Rentals vs. Temperature",
x="Temperature",
y="Bike Rentals") +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Boxplot of Bike Rentals by Humidity Level
plot3 <- ggplot(df, aes(x=hum_new, y=cnt, fill=hum_new)) +
geom_boxplot() +
labs(title="Bike Rentals by Humidity Level",
x="Humidity Level",
y="Bike Rentals") +
scale_fill_manual(values=c("lightblue", "lightgreen", "salmon")) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Text
text_box <- ggplot()+
annotate("text",
x= 0,
y=0,
label="description",
col='red',
size=10)
#Infographic
infographic <- plot1 /
plot_spacer() /
(plot2| plot3) /
text_box +
plot_layout(heights = c(1000, 0.1, 900) , widths = c(20,15,300)) +
plot_annotation(
title = "Effect of Tempetature and Humidity on Bike Rentals"
)
# Display the infographic
infographic
# Scatter plot of Temperature vs Rental Count with Humidity
plot1 <- ggplot(df, aes(x = temp*100, y = cnt, color = hum*100)) +
geom_point(size = 1, alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "brown") +
scale_color_viridis_c(option = "D") +
labs(
title = "Rental Count vs Temperature with Humidity Levels",
x = "Temperature (°C)",
y = "Bike Rentals",
color = "Humidity (%)"
) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Line chart of Bike Rentals vs Temperature
plot2 <- ggplot(df, aes(x=temp, y=cnt)) +
geom_line(color="royalblue") +
labs(title="Bike Rentals vs. Temperature",
x="Temperature",
y="Bike Rentals") +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Boxplot of Bike Rentals by Humidity Level
plot3 <- ggplot(df, aes(x=hum_new, y=cnt, fill=hum_new)) +
geom_boxplot() +
labs(title="Bike Rentals by Humidity Level",
x="Humidity Level",
y="Bike Rentals") +
scale_fill_manual(values=c("lightblue", "lightgreen", "salmon")) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Text
text_box <- ggplot()+
annotate("text",
x= 0,
y=0,
label="desc",
col='red',
size=4)
#Infographic
infographic <- plot1 /
plot_spacer() /
(plot2| plot3) /
text_box
+
plot_layout(heights = c(1000, 0.1, 900) , widths = c(20,15,300)) +
plot_annotation(
title = "Effect of Tempetature and Humidity on Bike Rentals"
)
# Scatter plot of Temperature vs Rental Count with Humidity
plot1 <- ggplot(df, aes(x = temp*100, y = cnt, color = hum*100)) +
geom_point(size = 1, alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "brown") +
scale_color_viridis_c(option = "D") +
labs(
title = "Rental Count vs Temperature with Humidity Levels",
x = "Temperature (°C)",
y = "Bike Rentals",
color = "Humidity (%)"
) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Line chart of Bike Rentals vs Temperature
plot2 <- ggplot(df, aes(x=temp, y=cnt)) +
geom_line(color="royalblue") +
labs(title="Bike Rentals vs. Temperature",
x="Temperature",
y="Bike Rentals") +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Boxplot of Bike Rentals by Humidity Level
plot3 <- ggplot(df, aes(x=hum_new, y=cnt, fill=hum_new)) +
geom_boxplot() +
labs(title="Bike Rentals by Humidity Level",
x="Humidity Level",
y="Bike Rentals") +
scale_fill_manual(values=c("lightblue", "lightgreen", "salmon")) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Text
text_box <- ggplot()+
annotate("text",
x= 0,
y=0,
label="desc",
col='red',
size=4)
#Infographic
infographic <- plot1 /
plot_spacer() /
(plot2| plot3) /
text_box
+
plot_layout(heights = c(1000, 0.1, 900,200) , widths = c(20,15,300)) +
plot_annotation(
title = "Effect of Tempetature and Humidity on Bike Rentals"
)
# Scatter plot of Temperature vs Rental Count with Humidity
plot1 <- ggplot(df, aes(x = temp*100, y = cnt, color = hum*100)) +
geom_point(size = 1, alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "brown") +
scale_color_viridis_c(option = "D") +
labs(
title = "Rental Count vs Temperature with Humidity Levels",
x = "Temperature (°C)",
y = "Bike Rentals",
color = "Humidity (%)"
) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Line chart of Bike Rentals vs Temperature
plot2 <- ggplot(df, aes(x=temp, y=cnt)) +
geom_line(color="royalblue") +
labs(title="Bike Rentals vs. Temperature",
x="Temperature",
y="Bike Rentals") +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Boxplot of Bike Rentals by Humidity Level
plot3 <- ggplot(df, aes(x=hum_new, y=cnt, fill=hum_new)) +
geom_boxplot() +
labs(title="Bike Rentals by Humidity Level",
x="Humidity Level",
y="Bike Rentals") +
scale_fill_manual(values=c("lightblue", "lightgreen", "salmon")) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Text
text_box <- ggplot()+
annotate("text",
x= 0,
y=0,
label="desc",
col='red',
size=4)
#Infographic
infographic <- plot1 /
plot_spacer() /
(plot2| plot3) /
text_box
+
plot_layout(heights = c(1000, 0.1, 900,200) , widths = c(20,15,300))
# Scatter plot of Temperature vs Rental Count with Humidity
plot1 <- ggplot(df, aes(x = temp*100, y = cnt, color = hum*100)) +
geom_point(size = 1, alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "brown") +
scale_color_viridis_c(option = "D") +
labs(
title = "Rental Count vs Temperature with Humidity Levels",
x = "Temperature (°C)",
y = "Bike Rentals",
color = "Humidity (%)"
) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Line chart of Bike Rentals vs Temperature
plot2 <- ggplot(df, aes(x=temp, y=cnt)) +
geom_line(color="royalblue") +
labs(title="Bike Rentals vs. Temperature",
x="Temperature",
y="Bike Rentals") +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Boxplot of Bike Rentals by Humidity Level
plot3 <- ggplot(df, aes(x=hum_new, y=cnt, fill=hum_new)) +
geom_boxplot() +
labs(title="Bike Rentals by Humidity Level",
x="Humidity Level",
y="Bike Rentals") +
scale_fill_manual(values=c("lightblue", "lightgreen", "salmon")) +
theme_minimal()+
theme(    axis.title = element_text(size = 7),
axis.text = element_text(size = 7),
title = element_text(size = 6))
# Text
text_box <- ggplot()+
annotate("text",
x= 0,
y=0,
label="desc",
col='red',
size=4)
#Infographic
infographic <- plot1 /
plot_spacer() /
(plot2| plot3) +
plot_layout(heights = c(1000, 0.1, 900) , widths = c(20,15,300)) +
plot_annotation(
title = "Effect of Tempetature and Humidity on Bike Rentals"
)
# Display the infographic
infographic
#| label: analyze-results-prop-reject
results %>% glimpse()
#| label: load-packages
#| warning: false
#| message: false
library(foreach)
library(doParallel)
library(infer)
library(dplyr)
#| label: for-loop-idea
n <- 1000
my_results <- numeric(n)
for (i in 1:n){
my_results[i] <- i^2
}
my_results %>% glimpse()
my_colours <- c("red", "green", "blue", "indigo")
for (col in my_colours){
print(col)
str(col)
}
#| label: foreach-loop-idea
n <- 1000
my_results <- foreach(i = 1:n, .combine = c) %do% {
i^2
}
my_results %>% glimpse()
#| label: foreach-loop-idea-v2
# need to "combine" the results in some way that isn't a list ...
n <- 1000
my_results <- foreach(i = 1:n) %do% {
i^2
}
my_results[1:6] %>% glimpse()
#| label: doParallel-loop-idea
cl <- makeCluster(7)
registerDoParallel(cl)
n <- 1000
my_results <- foreach(i = 1:n) %dopar% {
i^2
}
stopCluster(cl)
#| label: population-setup
# sample size
n <- 10000
# population parameter for the Bernoulli distribution
p <- 0.0007
#| label: sim-setup
nsim <- 10000
alpha <- 0.1 # 10% significance level
#| label: run-sim
#| warning: false
#| message: false
#| cache: true
# set.seed(1234)
# make a cluster if you want
ncores <- detectCores()-2
cl <- makeCluster(ncores)
registerDoParallel(cl)
# run the simulation using either %do% or %dopar%
results <- foreach(i = 1:nsim, .combine = rbind,
.packages = c("dplyr", "infer")) %dopar% {
cur_samp <- rbinom(1, size = n, prob = p)
test_exact <- binom.test(x = cur_samp, n = n, p = p,
alternative = "greater")
phat <- cur_samp / n
se <- sqrt(p * (1 - p) / n)
z <- (phat - p) / se
pval_clt <- pnorm(z, lower.tail = FALSE)
# test_clt <- prop.test(x = cur_samp, n = n, p = p,
#                       alternative = "two.sided", correct = FALSE)
obs_df <- data.frame(outcome = c(rep("yes", cur_samp),
rep("no", n - cur_samp)))
if (cur_samp == 0){
pval_boot <- 1
} else {
pval_boot <- obs_df %>%
specify(response = outcome, success = "yes") %>%
hypothesize(null = "point", p = p) %>%
generate(reps = 3000, type = "draw") %>%
calculate(stat = "prop") %>%
get_p_value(obs_stat = phat, direction = "greater") %>%
as.numeric()
}
data.frame(exact_reject = test_exact$p.value < alpha,
clt_reject = pval_clt < alpha,
# boot_reject = FALSE
boot_reject = pval_boot < alpha
)
}
pwd
setwd("~/Trent U/5240 Stats/Workshops/Workshop 07")
library(dplyr)
5240-mean-reject-ws07.rds
results <- readRDS(file="5240-mean-reject-ws07.rds")
glimpse(results)
boot_sum <- sum(results$boot)
boot_sum
binom.test(boot_sum,10000, 0.10)
boot.sum <- sum(results$boot)
boot.sum
binom.test(boot.sum,10000, 0.10)
clt_sum <- sum(results$clt)
clt_sum
binom.test(clt_sum,10000,0.10)
exact_sum <- sum(results$exact)
exact_sum
binom.test(exact_sum,10000,0.10)
binom.test(clt_sum,10000,0.10)
exact_sum <- sum(results$exact)
exact_sum
binom.test(exact_sum,10000,0.10)
